{"ast":null,"code":"/*\n\tcompiles a selector to an executable function\n*/\n\nmodule.exports = compile;\nmodule.exports.compileUnsafe = compileUnsafe;\nvar parse = require(\"css-what\"),\n  DomUtils = require(\"domutils\"),\n  isTag = DomUtils.isTag,\n  Rules = require(\"./general.js\"),\n  sortRules = require(\"./sort.js\"),\n  BaseFuncs = require(\"boolbase\"),\n  trueFunc = BaseFuncs.trueFunc,\n  falseFunc = BaseFuncs.falseFunc,\n  procedure = require(\"./procedure.json\");\nfunction compile(selector, options) {\n  var next = compileUnsafe(selector, options);\n  return wrap(next);\n}\nfunction wrap(next) {\n  return function base(elem) {\n    return isTag(elem) && next(elem);\n  };\n}\nfunction compileUnsafe(selector, options) {\n  var token = parse(selector, options);\n  return compileToken(token, options);\n}\nfunction compileToken(token, options) {\n  token.forEach(sortRules);\n  if (options && options.context) {\n    var ctx = options.context;\n    token.forEach(function (t) {\n      if (!isTraversal(t[0])) {\n        t.unshift({\n          type: \"descendant\"\n        });\n      }\n    });\n    var context = Array.isArray(ctx) ? function (elem) {\n      return ctx.indexOf(elem) >= 0;\n    } : function (elem) {\n      return ctx === elem;\n    };\n    if (options.rootFunc) {\n      var root = options.rootFunc;\n      options.rootFunc = function (elem) {\n        return context(elem) && root(elem);\n      };\n    } else {\n      options.rootFunc = context;\n    }\n  }\n  return token.map(compileRules, options).reduce(reduceRules, falseFunc);\n}\nfunction isTraversal(t) {\n  return procedure[t.type] < 0;\n}\nfunction compileRules(rules) {\n  if (rules.length === 0) return falseFunc;\n  var options = this;\n  return rules.reduce(function (func, rule) {\n    if (func === falseFunc) return func;\n    return Rules[rule.type](func, rule, options);\n  }, options && options.rootFunc || trueFunc);\n}\nfunction reduceRules(a, b) {\n  if (b === falseFunc || a === trueFunc) {\n    return a;\n  }\n  if (a === falseFunc || b === trueFunc) {\n    return b;\n  }\n  return function combine(elem) {\n    return a(elem) || b(elem);\n  };\n}\n\n//:not, :has and :matches have to compile selectors\n//doing this in lib/pseudos.js would lead to circular dependencies,\n//so we add them here\n\nvar Pseudos = require(\"./pseudos.js\"),\n  filters = Pseudos.filters,\n  existsOne = DomUtils.existsOne,\n  isTag = DomUtils.isTag,\n  getChildren = DomUtils.getChildren;\nfunction containsTraversal(t) {\n  return t.some(isTraversal);\n}\nfunction stripQuotes(str) {\n  var firstChar = str.charAt(0);\n  if (firstChar === str.slice(-1) && (firstChar === \"'\" || firstChar === \"\\\"\")) {\n    str = str.slice(1, -1);\n  }\n  return str;\n}\nfilters.not = function (next, select, options) {\n  var func,\n    opts = {\n      xmlMode: !!(options && options.xmlMode),\n      strict: !!(options && options.strict)\n    };\n  select = stripQuotes(select);\n  if (opts.strict) {\n    var tokens = parse(select);\n    if (tokens.length > 1 || tokens.some(containsTraversal)) {\n      throw new SyntaxError(\"complex selectors in :not aren't allowed in strict mode\");\n    }\n    func = compileToken(tokens, opts);\n  } else {\n    func = compileUnsafe(select, opts);\n  }\n  if (func === falseFunc) return next;\n  if (func === trueFunc) return falseFunc;\n  return function (elem) {\n    return !func(elem) && next(elem);\n  };\n};\nfilters.has = function (next, selector, options) {\n  //TODO add a dynamic context in front of every selector with a traversal\n  //:has will never be reached with options.strict == true\n  var opts = {\n    xmlMode: !!(options && options.xmlMode),\n    strict: !!(options && options.strict)\n  };\n  var func = compileUnsafe(selector, opts);\n  if (func === falseFunc) return falseFunc;\n  if (func === trueFunc) return function (elem) {\n    return getChildren(elem).some(isTag) && next(elem);\n  };\n  func = wrap(func);\n  return function has(elem) {\n    return next(elem) && existsOne(func, getChildren(elem));\n  };\n};\nfilters.matches = function (next, selector, options) {\n  var opts = {\n    xmlMode: !!(options && options.xmlMode),\n    strict: !!(options && options.strict),\n    rootFunc: next\n  };\n  selector = stripQuotes(selector);\n  return compileUnsafe(selector, opts);\n};","map":{"version":3,"names":["module","exports","compile","compileUnsafe","parse","require","DomUtils","isTag","Rules","sortRules","BaseFuncs","trueFunc","falseFunc","procedure","selector","options","next","wrap","base","elem","token","compileToken","forEach","context","ctx","t","isTraversal","unshift","type","Array","isArray","indexOf","rootFunc","root","map","compileRules","reduce","reduceRules","rules","length","func","rule","a","b","combine","Pseudos","filters","existsOne","getChildren","containsTraversal","some","stripQuotes","str","firstChar","charAt","slice","not","select","opts","xmlMode","strict","tokens","SyntaxError","has","matches"],"sources":["/Users/terencemui/Documents/ttWebsite/tt-website/node_modules/cheerio/node_modules/css-select/lib/compile.js"],"sourcesContent":["/*\n\tcompiles a selector to an executable function\n*/\n\nmodule.exports = compile;\nmodule.exports.compileUnsafe = compileUnsafe;\n\nvar parse       = require(\"css-what\"),\n    DomUtils    = require(\"domutils\"),\n    isTag       = DomUtils.isTag,\n    Rules       = require(\"./general.js\"),\n    sortRules   = require(\"./sort.js\"),\n    BaseFuncs   = require(\"boolbase\"),\n    trueFunc    = BaseFuncs.trueFunc,\n    falseFunc   = BaseFuncs.falseFunc,\n    procedure   = require(\"./procedure.json\");\n\nfunction compile(selector, options){\n\tvar next = compileUnsafe(selector, options);\n\treturn wrap(next);\n}\n\nfunction wrap(next){\n\treturn function base(elem){\n\t\treturn isTag(elem) && next(elem);\n\t};\n}\n\nfunction compileUnsafe(selector, options){\n\tvar token = parse(selector, options);\n\treturn compileToken(token, options);\n}\n\nfunction compileToken(token, options){\n\ttoken.forEach(sortRules);\n\n\tif(options && options.context){\n\t\tvar ctx = options.context;\n\n\t\ttoken.forEach(function(t){\n\t\t\tif(!isTraversal(t[0])){\n\t\t\t\tt.unshift({type: \"descendant\"});\n\t\t\t}\n\t\t});\n\n\t\tvar context = Array.isArray(ctx) ?\n\t\t\tfunction(elem){\n\t\t\t\treturn ctx.indexOf(elem) >= 0;\n\t\t\t} : function(elem){\n\t\t\t\treturn ctx === elem;\n\t\t\t};\n\n\t\tif(options.rootFunc){\n\t\t\tvar root = options.rootFunc;\n\n\t\t\toptions.rootFunc = function(elem){\n\t\t\t\treturn context(elem) && root(elem);\n\t\t\t};\n\t\t} else {\n\t\t\toptions.rootFunc = context;\n\t\t}\n\t}\n\n\treturn token\n\t\t.map(compileRules, options)\n\t\t.reduce(reduceRules, falseFunc);\n}\n\nfunction isTraversal(t){\n\treturn procedure[t.type] < 0;\n}\n\nfunction compileRules(rules){\n\tif(rules.length === 0) return falseFunc;\n\n\tvar options = this;\n\n\treturn rules.reduce(function(func, rule){\n\t\tif(func === falseFunc) return func;\n\t\treturn Rules[rule.type](func, rule, options);\n\t}, options && options.rootFunc || trueFunc);\n}\n\nfunction reduceRules(a, b){\n\tif(b === falseFunc || a === trueFunc){\n\t\treturn a;\n\t}\n\tif(a === falseFunc || b === trueFunc){\n\t\treturn b;\n\t}\n\n\treturn function combine(elem){\n\t\treturn a(elem) || b(elem);\n\t};\n}\n\n//:not, :has and :matches have to compile selectors\n//doing this in lib/pseudos.js would lead to circular dependencies,\n//so we add them here\n\nvar Pseudos     = require(\"./pseudos.js\"),\n    filters     = Pseudos.filters,\n    existsOne   = DomUtils.existsOne,\n    isTag       = DomUtils.isTag,\n    getChildren = DomUtils.getChildren;\n\n\nfunction containsTraversal(t){\n\treturn t.some(isTraversal);\n}\n\nfunction stripQuotes(str){\n\tvar firstChar = str.charAt(0);\n\n\tif(firstChar === str.slice(-1) && (firstChar === \"'\" || firstChar === \"\\\"\")){\n\t\tstr = str.slice(1, -1);\n\t}\n\n\treturn str;\n}\n\nfilters.not = function(next, select, options){\n\tvar func,\n\t    opts = {\n\t    \txmlMode: !!(options && options.xmlMode),\n\t    \tstrict: !!(options && options.strict)\n\t    };\n\n\tselect = stripQuotes(select);\n\n\tif(opts.strict){\n\t\tvar tokens = parse(select);\n\t\tif(tokens.length > 1 || tokens.some(containsTraversal)){\n\t\t\tthrow new SyntaxError(\"complex selectors in :not aren't allowed in strict mode\");\n\t\t}\n\n\t\tfunc = compileToken(tokens, opts);\n\t} else {\n\t\tfunc = compileUnsafe(select, opts);\n\t}\n\n\tif(func === falseFunc) return next;\n\tif(func === trueFunc)  return falseFunc;\n\n\treturn function(elem){\n\t\treturn !func(elem) && next(elem);\n\t};\n};\n\nfilters.has = function(next, selector, options){\n\t//TODO add a dynamic context in front of every selector with a traversal\n\t//:has will never be reached with options.strict == true\n\tvar opts = {\n\t\txmlMode: !!(options && options.xmlMode),\n\t\tstrict: !!(options && options.strict)\n\t};\n\tvar func = compileUnsafe(selector, opts);\n\n\tif(func === falseFunc) return falseFunc;\n\tif(func === trueFunc)  return function(elem){\n\t\t\treturn getChildren(elem).some(isTag) && next(elem);\n\t\t};\n\n\tfunc = wrap(func);\n\n\treturn function has(elem){\n\t\treturn next(elem) && existsOne(func, getChildren(elem));\n\t};\n};\n\nfilters.matches = function(next, selector, options){\n\tvar opts = {\n\t\txmlMode: !!(options && options.xmlMode),\n\t\tstrict: !!(options && options.strict),\n\t\trootFunc: next\n\t};\n\n\tselector = stripQuotes(selector);\n\n\treturn compileUnsafe(selector, opts);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}